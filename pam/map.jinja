{% set pam = salt['grains.filter_by']({
    'Ubuntu': {
        'ldap_pkg': 'libpam-ldapd',
        'nsd': 'nscd',
        'ldap_config': '/etc/ldap.conf',
        'mkhomedir_pkg': 'libpam-mkhomedir',
        'mkhomedir_config': '/usr/share/pam-configs/mkhomedir',
        'ccreds_pkg': 'libpam-ccreds',
        'pam_config': {},
    },
    'Debian': {
        'ldap_pkg': 'libpam-ldapd',
        'ldap_config': '/etc/ldap.conf',
        'mkhomedir_pkg': 'libpam-ccreds',
        'mkhomedir_config': '/usr/share/pam-configs/mkhomedir',
        'ccreds_pkg': 'libpam-ccreds',
        'pam_config': {},
    },
    'Debian': {
        'ldap_pkg': 'pam_ldap',
        'ldap_config': '/usr/local/etc/ldap.conf',
        'mkhomedir_pkg': 'pam_mkhomedir',
        'mkhomedir_config': False,
        'pam_config': {},
    },
}, merge=salt['pillar.get']('pam:lookup')) %}
